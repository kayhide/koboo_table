(function(){var t;t=function(){function t(t){this.root=t,this.items=ko.observableArray(),this.all_items=[]}return t.prototype.update_items=function(){var t,r,o,e,i;for(this.update_sort(),this.update_filter(),r=this.all_items,this.current_sort&&(r=this.sort_items(r,this.current_sort,this.sort_down)),r=this.filter_items(r),this.items.removeAll(),i=[],o=0,e=r.length;e>o;o++)t=r[o],i.push(this.items.push(t));return i},t.prototype.sort_items=function(t,r,o){return t=t.sort(function(){return function(t,e){var i,n;return i=t[r],n=e[r],"number"==typeof i&&"number"==typeof n?i-n:"number"==typeof i?o?1:-1:"number"==typeof n?o?-1:1:String(i).localeCompare(String(n))}}(this)),o&&t.reverse(),t},t.prototype.filter_items=function(t){var r;return t=function(){var o,e,i;for(i=[],o=0,e=t.length;e>o;o++)r=t[o],this.filter(r)&&i.push(r);return i}.call(this)},t.prototype.filter=function(t){var r,o,e,i,n;for(r=!0,n=this.filters,e=0,i=n.length;i>e;e++)o=n[e],r=r&&o(t);return r},t.prototype.update_sort=function(){var t;return this.last_sort=this.current_sort,t=this.root.find(".sort-up,.sort-down"),this.current_sort=t.data("koboo-sort"),this.sort_down=t.hasClass("sort-down")},t.prototype.update_filter=function(){var t,r,o,e,i,n,s,u,l,f,a,h,p,c;for(s={},r={},p=this.root.find(".filter:checked"),l=0,a=p.length;a>l;l++)t=p[l],n=$(t).data("koboo-filter"),$(t).data("koboo-filter-gt")||$(t).data("koboo-filter-gte")||$(t).data("koboo-filter-lt")||$(t).data("koboo-filter-lte")?r[n]={gt:Number($(t).data("koboo-filter-gt")),gte:Number($(t).data("koboo-filter-gte")),lt:Number($(t).data("koboo-filter-lt")),lte:Number($(t).data("koboo-filter-lte"))}:(null==s[n]&&(s[n]=[]),s[n].push($(t).data("koboo-filter-text")||$(t).closest("label").text()));for(this.filters=function(){var t;t=[];for(n in s)u=s[n],u.length>0&&t.push(function(t,r){return function(o){return o[t].match(new RegExp(r.join("|")))}}(n,u));return t}(),i=function(){var t;t=[];for(n in r)o=r[n],t.push(function(t,r){return function(o){return(!r.gt||o[t]>r.gt)&&(!r.gte||o[t]>=r.gte)&&(!r.lt||o[t]<r.lt)&&(!r.lte||o[t]<=r.lte)}}(n,o));return t}(),c=[],f=0,h=i.length;h>f;f++)e=i[f],c.push(this.filters.push(e));return c},t}(),this.KobooViewModel=t}).call(this);
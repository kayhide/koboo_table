(function(){var t;t=function(){function t(){this.items=ko.observableArray()}return t.prototype.update_items=function(){var r,o,e,n,i;for(this.update_sort(),this.update_filter(),o=t.all,this.current_sort&&(o=this.sort_items(o,this.current_sort,this.sort_down)),o=this.filter_items(o),this.items.removeAll(),i=[],e=0,n=o.length;n>e;e++)r=o[e],i.push(this.items.push(r));return i},t.prototype.sort_items=function(t,r,o){return t=t.sort(function(){return function(t,o){var e,n;return e=t[r],n=o[r],"number"==typeof e&&"number"==typeof n?e-n:String(e).localeCompare(String(n))}}(this)),o&&t.reverse(),t},t.prototype.filter_items=function(t){var r;return t=function(){var o,e,n;for(n=[],o=0,e=t.length;e>o;o++)r=t[o],this.filter(r)&&n.push(r);return n}.call(this)},t.prototype.filter=function(t){var r,o,e,n,i;for(r=!0,i=this.filters,e=0,n=i.length;n>e;e++)o=i[e],r=r&&o(t);return r},t.prototype.update_sort=function(){var t;return this.last_sort=this.current_sort,t=$(".sort-up,.sort-down"),this.current_sort=t.data("koboo-sort"),this.sort_down=t.hasClass("sort-down")},t.prototype.update_filter=function(){var t,r,o,e,n,i,s,u,l,a,f,h,p,c;for(s={},r={},p=$(".filter:checked"),l=0,f=p.length;f>l;l++)t=p[l],i=$(t).data("koboo-filter"),$(t).data("koboo-filter-gt")||$(t).data("koboo-filter-gte")||$(t).data("koboo-filter-lt")||$(t).data("koboo-filter-lte")?r[i]={gt:Number($(t).data("koboo-filter-gt")),gte:Number($(t).data("koboo-filter-gte")),lt:Number($(t).data("koboo-filter-lt")),lte:Number($(t).data("koboo-filter-lte"))}:(null==s[i]&&(s[i]=[]),s[i].push($(t).data("koboo-filter-text")||$(t).closest("label").text()));for(this.filters=function(){var t;t=[];for(i in s)u=s[i],u.length>0&&t.push(function(t,r){return function(o){return o[t].match(new RegExp(r.join("|")))}}(i,u));return t}(),n=function(){var t;t=[];for(i in r)o=r[i],t.push(function(t,r){return function(o){return(!r.gt||o[t]>r.gt)&&(!r.gte||o[t]>=r.gte)&&(!r.lt||o[t]<r.lt)&&(!r.lte||o[t]<=r.lte)}}(i,o));return t}(),c=[],a=0,h=n.length;h>a;a++)e=n[a],c.push(this.filters.push(e));return c},t}(),this.KobooViewModel=t}).call(this);
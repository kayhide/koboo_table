(function(){var t;t=function(){function t(){this.items=ko.observableArray()}return t.prototype.update_items=function(){var r,e,o,n,i;for(this.update_sort(),this.update_filter(),e=t.all,this.current_sort&&(e=this.sort_items(e,this.current_sort,this.sort_down)),e=this.filter_items(e),this.items.removeAll(),i=[],o=0,n=e.length;n>o;o++)r=e[o],i.push(this.items.push(r));return i},t.prototype.sort_items=function(t,r,e){return t=t.sort(function(){return function(t,o){var n,i;return n=t[r],i=o[r],"number"==typeof n&&"number"==typeof i?n-i:"number"==typeof n?e?1:-1:"number"==typeof i?e?-1:1:String(n).localeCompare(String(i))}}(this)),e&&t.reverse(),t},t.prototype.filter_items=function(t){var r;return t=function(){var e,o,n;for(n=[],e=0,o=t.length;o>e;e++)r=t[e],this.filter(r)&&n.push(r);return n}.call(this)},t.prototype.filter=function(t){var r,e,o,n,i;for(r=!0,i=this.filters,o=0,n=i.length;n>o;o++)e=i[o],r=r&&e(t);return r},t.prototype.update_sort=function(){var t;return this.last_sort=this.current_sort,t=$(".sort-up,.sort-down"),this.current_sort=t.data("koboo-sort"),this.sort_down=t.hasClass("sort-down")},t.prototype.update_filter=function(){var t,r,e,o,n,i,s,u,l,a,f,h,p,c;for(s={},r={},p=$(".filter:checked"),l=0,f=p.length;f>l;l++)t=p[l],i=$(t).data("koboo-filter"),$(t).data("koboo-filter-gt")||$(t).data("koboo-filter-gte")||$(t).data("koboo-filter-lt")||$(t).data("koboo-filter-lte")?r[i]={gt:Number($(t).data("koboo-filter-gt")),gte:Number($(t).data("koboo-filter-gte")),lt:Number($(t).data("koboo-filter-lt")),lte:Number($(t).data("koboo-filter-lte"))}:(null==s[i]&&(s[i]=[]),s[i].push($(t).data("koboo-filter-text")||$(t).closest("label").text()));for(this.filters=function(){var t;t=[];for(i in s)u=s[i],u.length>0&&t.push(function(t,r){return function(e){return e[t].match(new RegExp(r.join("|")))}}(i,u));return t}(),n=function(){var t;t=[];for(i in r)e=r[i],t.push(function(t,r){return function(e){return(!r.gt||e[t]>r.gt)&&(!r.gte||e[t]>=r.gte)&&(!r.lt||e[t]<r.lt)&&(!r.lte||e[t]<=r.lte)}}(i,e));return t}(),c=[],a=0,h=n.length;h>a;a++)o=n[a],c.push(this.filters.push(o));return c},t}(),this.KobooViewModel=t}).call(this);